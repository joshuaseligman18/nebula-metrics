CREATE TABLE PROCESS (
    PID            INT    NOT NULL CHECK(PID >= 1),
    EXEC           TEXT   NOT NULL,
    START_TIME     INT    NOT NULL CHECK(START_TIME >= 0),
    IS_ALIVE       INT    NOT NULL CHECK(IS_ALIVE IN (0, 1)),
    INIT_TOTAL_CPU REAL   NOT NULL CHECK(INIT_TOTAL_CPU >= 0),
    PRIMARY KEY (PID)
);

CREATE TABLE CPU (
    CPU_CORE     INT  NOT NULL CHECK(CPU_CORE >= 0),
    MHZ          REAL NOT NULL CHECK(MHZ >= 0),
    TOTAL_CACHE  INT  NOT NULL CHECK(TOTAL_CACHE >= 0),
    PRIMARY KEY (CPU_CORE)
);

CREATE TABLE PROCSTAT (
    PID              INT  NOT NULL,
    TIMESTAMP        INT  NOT NULL CHECK(TIMESTAMP >= 0),
    TOTAL_CPU        REAL NOT NULL CHECK(TOTAL_CPU >= 0),
    CPU_CORE         INT,
    VIRTUAL_MEMORY   INT  NOT NULL CHECK(VIRTUAL_MEMORY >= 0),
    RESIDENT_MEMORY  INT  NOT NULL CHECK(RESIDENT_MEMORY >= 0),
    SHARED_MEMORY    INT  NOT NULL CHECK(SHARED_MEMORY >= 0),
    PRIMARY KEY (PID, TIMESTAMP)
    FOREIGN KEY (PID)       REFERENCES PROCESS(PID),
    FOREIGN KEY (CPU_CORE)  REFERENCES CPU(CPU_CORE)
);

CREATE TABLE CPUSTAT (
    CPU_CORE    INT  NOT NULL,
    TIMESTAMP   INT  NOT NULL CHECK(TIMESTAMP >= 0),
    USAGE       REAL NOT NULL CHECK(USAGE >= 0),
    PRIMARY KEY (CPU_CORE, TIMESTAMP)
);

CREATE TABLE MEMORY (
    TIMESTAMP   INT  NOT NULL CHECK(TIMESTAMP >= 0),
    TOTAL       INT  NOT NULL CHECK(TOTAL >= 0),
    FREE        INT  NOT NULL CHECK(FREE >= 0 AND FREE <= TOTAL),
    SWAP_TOTAL  INT  NOT NULL CHECK(SWAP_TOTAL >= 0),
    SWAP_FREE   INT  NOT NULL CHECK(SWAP_FREE >= 0 AND SWAP_FREE <= SWAP_TOTAL),
    PRIMARY KEY (TIMESTAMP)
);

CREATE TABLE DISK (
    DEVICE_NAME TEXT NOT NULL,
    MOUNT       TEXT NOT NULL,
    FS_TYPE     TEXT NOT NULL,
    PRIMARY KEY (DEVICE_NAME)
);

CREATE TABLE DISKSTAT (
    DEVICE_NAME TEXT NOT NULL,
    TIMESTAMP   INT  NOT NULL CHECK(TIMESTAMP >= 0),
    USED        INT  NOT NULL CHECK(USED >= 0),
    AVAILABLE   INT  NOT NULL CHECK(AVAILABLE >= 0),
    PRIMARY KEY (DEVICE_NAME, TIMESTAMP),
    FOREIGN KEY (DEVICE_NAME) REFERENCES DISK(DEVICE_NAME)
);


INSERT INTO CPU VALUES(0, 4200, 2112);
INSERT INTO PROCESS VALUES(1, "test-exe", 1234567890, FALSE, 500);
INSERT INTO PROCESS VALUES(2, "old-exe", 1234567890, TRUE, 42);
INSERT INTO PROCSTAT VALUES(1, 50, 500, 0, 42, 42, 0);
INSERT INTO PROCSTAT VALUES(1, 9999999999, 500, 0, 42, 42, 0);
INSERT INTO PROCSTAT VALUES(2, 50, 500, 0, 42, 42, 0);
INSERT INTO CPUSTAT VALUES(0, 50, 999);
INSERT INTO CPUSTAT VALUES(0, 9999999999, 400);
INSERT INTO MEMORY VALUES(50, 50, 50, 50, 50, 50);
INSERT INTO MEMORY VALUES(9999999999, 50, 50, 50, 50, 50);
INSERT INTO DISK VALUES("/my/fs", "/", "ext4");
INSERT INTO DISKSTAT VALUES("/my/fs", 50, 50, 50);
INSERT INTO DISKSTAT VALUES("/my/fs", 999999999, 50, 50);
